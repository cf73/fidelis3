{"version":3,"file":"PreOwned-DNgUQkkr.js","sources":["../../src/pages/PreOwned.tsx"],"sourcesContent":["/**\n * @preserve-visual-language\n * DO NOT MODIFY: Functionality, data handling, or business logic\n * Only modify: Visual styling, layout, and user experience\n * \n * Visual Language:\n * - Colors: Primary blue, accent gold, neutral grays\n * - Typography: Inter font, established scale\n * - Spacing: 4px base unit system\n * - Layout: Responsive grid, consistent padding\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { motion } from 'framer-motion';\nimport { MagnifyingGlassIcon, TagIcon, TruckIcon, CubeIcon } from '@heroicons/react/24/outline';\nimport { getPreOwned, getImageUrl, type PreOwned } from '../lib/supabase';\nimport { \n  Section, \n  Container, \n  Grid, \n  Flex, \n  H1, \n  H2, \n  H3, \n  Body, \n  BodyLarge, \n  Button,\n  PreOwnedCard,\n  ValueCard\n} from '../components/ui';\nimport { getRandomMusicalMessage } from '../utils/musicalLoadingMessages';\n\nconst PreOwned: React.FC = () => {\n  const [preOwnedItems, setPreOwnedItems] = useState<PreOwned[]>([]);\n  const [filteredItems, setFilteredItems] = useState<PreOwned[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [showLocalOnly, setShowLocalOnly] = useState(false);\n  const [showInitialSpinner, setShowInitialSpinner] = useState(true);\n  const [cardsVisible, setCardsVisible] = useState<boolean[]>([]);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const data = await getPreOwned();\n        setPreOwnedItems(data);\n        setFilteredItems(data);\n        \n        // Preload all first images\n        const preloadPromises = data.map(item => {\n          return new Promise<void>((resolve) => {\n            if (item.images && item.images.length > 0) {\n              const img = new Image();\n              img.onload = () => resolve();\n              img.onerror = () => resolve(); // Resolve even on error\n              img.src = getImageUrl(item.images[0]);\n            } else {\n              resolve(); // No image to load\n            }\n          });\n        });\n        \n        // Wait for all images to preload (with timeout)\n        const preloadWithTimeout = Promise.race([\n          Promise.all(preloadPromises),\n          new Promise(resolve => setTimeout(resolve, 3000)) // 3 second timeout\n        ]);\n        \n        await preloadWithTimeout;\n        \n        // Initialize cards as hidden\n        setCardsVisible(new Array(data.length).fill(false));\n        \n        // Hide spinner and start sequential animation\n        setShowInitialSpinner(false);\n        \n        // Trigger sequential card animation\n        setTimeout(() => {\n          data.forEach((_, index) => {\n            setTimeout(() => {\n              setCardsVisible(prev => {\n                const newVisible = [...prev];\n                newVisible[index] = true;\n                return newVisible;\n              });\n            }, index * 80); // Fast 80ms intervals\n          });\n        }, 200); // Brief delay after spinner disappears\n        \n      } catch (error) {\n        console.error('Error loading pre-owned data:', error);\n        setPreOwnedItems([]);\n        setFilteredItems([]);\n        setShowInitialSpinner(false);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchData();\n  }, []);\n\n  useEffect(() => {\n    let filtered = preOwnedItems;\n\n    // Search filter\n    if (searchTerm) {\n      filtered = filtered.filter(item =>\n        item.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        item.description?.toLowerCase().includes(searchTerm.toLowerCase())\n      );\n    }\n\n    // Local only filter\n    if (showLocalOnly) {\n      filtered = filtered.filter(item => item.local_only);\n    }\n\n    setFilteredItems(filtered);\n    \n    // Reset and animate cards when filters change\n    if (filtered.length !== filteredItems.length) {\n      setCardsVisible(new Array(filtered.length).fill(false));\n      setTimeout(() => {\n        filtered.forEach((_, index) => {\n          setTimeout(() => {\n            setCardsVisible(prev => {\n              const newVisible = [...prev];\n              newVisible[index] = true;\n              return newVisible;\n            });\n          }, index * 60); // Even faster for filter changes\n        });\n      }, 100);\n    }\n  }, [preOwnedItems, searchTerm, showLocalOnly, filteredItems.length]);\n\n  if (loading || showInitialSpinner) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-[#fffcf9]\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-600 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">{getRandomMusicalMessage()}</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      transition={{ duration: 0.5 }}\n      className=\"min-h-screen bg-[#fffcf9]\"\n    >\n      {/* Hero Section */}\n      <Section variant=\"hero\" background=\"custom\" customBackground=\"bg-warm-beige\" className=\"-mt-4\">\n        <Container size=\"6xl\">\n          <div className=\"max-w-4xl\">\n            <h1 className=\"text-4xl lg:text-5xl xl:text-6xl font-light text-stone-900 leading-tight tracking-wide mb-6\">Pre-Owned Equipment</h1>\n            <div className=\"prose prose-stone prose-lg max-w-none text-stone-700 leading-relaxed\">\n              <p className=\"mb-6\">\n                Quality audio gear is built to last. Many of the components we sell pre-owned deliver performance that rivals or exceeds newer equipment at significantly higher prices.\n              </p>\n              <p className=\"mb-6\">\n                We thoroughly test and inspect every item before it goes on our floor. Each piece meets the same standards we apply to new equipment.\n              </p>\n              <p>\n                Pre-owned gear offers serious value for both newcomers and seasoned audiophiles looking to upgrade or complete their systems.\n              </p>\n            </div>\n          </div>\n        </Container>\n      </Section>\n\n\n\n      {/* Results Grid */}\n      <Section variant=\"compact\" background=\"custom\" customBackground=\"bg-[#fffcf9]\">\n        <Container size=\"6xl\">\n          {filteredItems.length > 0 ? (\n            <>\n              {/* Search, Local Filter, and Results Count */}\n              <div className=\"mb-6 flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4\">\n                <div className=\"flex flex-col sm:flex-row items-start sm:items-center gap-4\">\n                  <div className=\"relative max-w-md\">\n                    <MagnifyingGlassIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                    <input\n                      type=\"text\"\n                      placeholder=\"Search...\"\n                      value={searchTerm}\n                      onChange={(e) => setSearchTerm(e.target.value)}\n                      className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-accent-500 focus:border-transparent transition-all duration-300 bg-white\"\n                    />\n                  </div>\n                  <label className=\"flex items-center gap-2 cursor-pointer whitespace-nowrap\">\n                    <input\n                      type=\"checkbox\"\n                      checked={showLocalOnly}\n                      onChange={(e) => setShowLocalOnly(e.target.checked)}\n                      className=\"rounded border-gray-300 text-accent-600 focus:ring-accent-500\"\n                    />\n                    <span className=\"text-sm text-gray-700\">Local pickup only</span>\n                  </label>\n                </div>\n                <p className=\"text-gray-600\">\n                  Showing {filteredItems.length} pre-owned item{filteredItems.length !== 1 ? 's' : ''}\n                </p>\n              </div>\n              \n              {/* Grid */}\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-10\">\n                {filteredItems.map((item, index) => (\n                  <Link key={item.id} to={`/pre-owned/${item.id}`} className=\"block h-full group\">\n                    <PreOwnedCard \n                      item={item} \n                      className=\"h-full\" \n                      index={index}\n                      isVisible={cardsVisible[index] || false}\n                    />\n                  </Link>\n                ))}\n              </div>\n            </>\n          ) : (\n            <div className=\"text-center py-16\">\n              <div className=\"text-6xl mb-4\">üîç</div>\n              <H3 className=\"mb-2\">No items found</H3>\n              <Body className=\"text-gray-600\">\n                Try adjusting your search criteria or check back later for new arrivals.\n              </Body>\n            </div>\n          )}\n        </Container>\n      </Section>\n\n      {/* Trade-In Section */}\n      <Section variant=\"compact\" background=\"custom\" customBackground=\"bg-warm-beige\">\n        <Container size=\"6xl\">\n          <div className=\"max-w-4xl\">\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6 }}\n              className=\"mb-8\"\n            >\n              <H2 className=\"text-stone-900 mb-6\">Trade In Your Gear</H2>\n              <div className=\"prose prose-stone prose-lg max-w-none text-stone-700 leading-relaxed\">\n                <p className=\"mb-6\">\n                  Looking to upgrade? We accept quality audio equipment as trade toward new gear. \n                  Our team evaluates each piece fairly, considering current market value and condition.\n                </p>\n                <p className=\"mb-8\">\n                  From vintage classics to recent high-end components, we're interested in gear that \n                  meets our standards. Trade values can significantly reduce the cost of your next upgrade.\n                </p>\n              </div>\n            </motion.div>\n            \n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6, delay: 0.2 }}\n            >\n              <Link\n                to=\"/contact?subject=Trade-In%20Inquiry&message=I%27m%20interested%20in%20trading%20in%20my%20audio%20equipment.%20Here%27s%20what%20I%20have%3A%0A%0A\"\n                className=\"inline-flex items-center gap-3 bg-stone-900 text-white px-8 py-4 font-medium tracking-wide hover:bg-stone-800 transition-all duration-300 shadow-sm hover:shadow-md group\"\n              >\n                Get Trade-In Quote\n                <svg className=\"w-4 h-4 group-hover:translate-x-0.5 transition-transform duration-300\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n                </svg>\n              </Link>\n            </motion.div>\n          </div>\n        </Container>\n      </Section>\n\n    </motion.div>\n  );\n};\n\nexport { PreOwned }; "],"names":["PreOwned","preOwnedItems","setPreOwnedItems","useState","filteredItems","setFilteredItems","loading","setLoading","searchTerm","setSearchTerm","showLocalOnly","setShowLocalOnly","showInitialSpinner","setShowInitialSpinner","cardsVisible","setCardsVisible","useEffect","data","getPreOwned","preloadPromises","item","resolve","img","getImageUrl","_","index","prev","newVisible","error","filtered","jsxs","jsx","motion","Section","Container","Fragment","MagnifyingGlassIcon","e","Link","PreOwnedCard","H3","Body","H2"],"mappings":"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"}